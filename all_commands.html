

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TCL/Python correspondence &mdash; psfgen 0.0.0a1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="psfgen 0.0.0a1 documentation" href="index.html"/>
        <link rel="next" title="Examples" href="examples.html"/>
        <link rel="prev" title="psfgen - python" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> psfgen
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TCL/Python correspondence</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#topology-and-naming-functions">Topology and naming functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-functions">Query functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-building-functions">System building functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-new-segment">Adding a new segment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#i-o-functions">I/O functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#context-functions">Context functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">psfgen</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>TCL/Python correspondence</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/all_commands.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tcl-python-correspondence">
<h1>TCL/Python correspondence<a class="headerlink" href="#tcl-python-correspondence" title="Permalink to this headline">¶</a></h1>
<p>Unlike TCL, Python is much more naturally object-oriented. This means that all
psfgen functionality is performed on a PsfGen object that holds the state of
the system. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psfgen</span> <span class="kn">import</span> <span class="n">PsfGen</span>
<span class="n">gen</span> <span class="o">=</span> <span class="n">PsfGen</span><span class="p">()</span>
</pre></div>
</div>
<p>Then all commands are done on the PsfGen object. The syntax in the following
table refers to this generic PsfGen object I’ve chosen to name <code class="docutils literal notranslate"><span class="pre">gen</span></code>.</p>
<div class="section" id="topology-and-naming-functions">
<h2>Topology and naming functions<a class="headerlink" href="#topology-and-naming-functions" title="Permalink to this headline">¶</a></h2>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="6%" />
<col width="47%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Task</th>
<th class="head">TCL command</th>
<th class="head">Python class equivalent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Load topology definitions</td>
<td><code class="docutils literal notranslate"><span class="pre">topology</span> <span class="pre">&lt;file</span> <span class="pre">name&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.read_topology(filename)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.read_topology" title="psfgen.PsfGen.read_topology"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.read_topology()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Provide alternate names for residues in topology file</td>
<td><code class="docutils literal notranslate"><span class="pre">topology</span> <span class="pre">alias</span> <span class="pre">&lt;desired</span> <span class="pre">residue</span> <span class="pre">name&gt;</span> <span class="pre">&lt;topology</span> <span class="pre">residue</span> <span class="pre">name&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.alias_residue(top_resname,</span> <span class="pre">pdb_resname)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.alias_residue" title="psfgen.PsfGen.alias_residue"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.alias_residue()</span></code></a></td>
</tr>
<tr class="row-even"><td>Provide alternate names for residues in pdb file</td>
<td><code class="docutils literal notranslate"><span class="pre">pdbalias</span> <span class="pre">residue</span> <span class="pre">&lt;PDB</span> <span class="pre">residue</span> <span class="pre">name&gt;</span> <span class="pre">&lt;desired</span> <span class="pre">residue</span> <span class="pre">name&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.alias_residue(top_resname,</span> <span class="pre">pdb_resname)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.alias_residue" title="psfgen.PsfGen.alias_residue"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.alias_residue()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Provide translations for atom names found in PDB files to those
in topology files</td>
<td><code class="docutils literal notranslate"><span class="pre">pdbalias</span> <span class="pre">atom</span> <span class="pre">&lt;residue</span> <span class="pre">name&gt;</span> <span class="pre">&lt;PDB</span> <span class="pre">atomname&gt;</span> <span class="pre">&lt;topology</span> <span class="pre">atomname&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.alias_atom(resname,</span> <span class="pre">pdb_atomname,</span> <span class="pre">top_atomname)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.alias_atom" title="psfgen.PsfGen.alias_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.alias_atom()</span></code></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="query-functions">
<h2>Query functions<a class="headerlink" href="#query-functions" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Task</th>
<th class="head">TCL command</th>
<th class="head">Python class equivalent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>List loaded topology files</td>
<td><code class="docutils literal notranslate"><span class="pre">topology</span> <span class="pre">list</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_topologies()</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_topologies" title="psfgen.PsfGen.get_topologies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_topologies()</span></code></a></td>
</tr>
<tr class="row-odd"><td>List current segids</td>
<td><code class="docutils literal notranslate"><span class="pre">segment</span> <span class="pre">segids</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_segids()</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_segids" title="psfgen.PsfGen.get_segids"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_segids()</span></code></a></td>
</tr>
<tr class="row-even"><td>List current resids in a segment</td>
<td><code class="docutils literal notranslate"><span class="pre">segment</span> <span class="pre">resids</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_resids(segid)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_resids" title="psfgen.PsfGen.get_resids"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_resids()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Get residue name given a resid and a segment</td>
<td><code class="docutils literal notranslate"><span class="pre">segment</span> <span class="pre">residue</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span> <span class="pre">&lt;resid&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_resname(segid,</span> <span class="pre">resid)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_resname" title="psfgen.PsfGen.get_resname"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_resname()</span></code></a></td>
</tr>
<tr class="row-even"><td>List all currently applied patches, including default patches</td>
<td><code class="docutils literal notranslate"><span class="pre">patch</span> <span class="pre">listall</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_patches()</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_patches" title="psfgen.PsfGen.get_patches"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_patches()</span></code></a></td>
</tr>
<tr class="row-odd"><td>List all explicitly applied patches</td>
<td><code class="docutils literal notranslate"><span class="pre">patch</span> <span class="pre">list</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_patches(list_defaults=False)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_patches" title="psfgen.PsfGen.get_patches"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_patches()</span></code></a></td>
</tr>
<tr class="row-even"><td>List all available residue types</td>
<td><code class="docutils literal notranslate"><span class="pre">topology</span> <span class="pre">residues</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_residue_types()</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_residue_types" title="psfgen.PsfGen.get_residue_types"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_residue_types()</span></code></a></td>
</tr>
<tr class="row-odd"><td>List all available patches</td>
<td><code class="docutils literal notranslate"><span class="pre">topology</span> <span class="pre">patches</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_patches(list_all=True)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_patches" title="psfgen.PsfGen.get_patches"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_patches()</span></code></a></td>
</tr>
<tr class="row-even"><td>Get the name of the patch applied to the beginning of a given segment</td>
<td><code class="docutils literal notranslate"><span class="pre">segment</span> <span class="pre">first</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_first(segid)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_first" title="psfgen.PsfGen.get_first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_first()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Get the name of the patch applied to the end of a given segment</td>
<td><code class="docutils literal notranslate"><span class="pre">segment</span> <span class="pre">last</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_last(segid)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_last" title="psfgen.PsfGen.get_last"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_last()</span></code></a></td>
</tr>
<tr class="row-even"><td>Get a list of atoms given a resid and segment</td>
<td><code class="docutils literal notranslate"><span class="pre">segment</span> <span class="pre">atoms</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span> <span class="pre">&lt;resid&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.get_atoms(segid,</span> <span class="pre">resid)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.get_atoms" title="psfgen.PsfGen.get_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.get_atoms()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Get x,y,z coordinates for a given atom</td>
<td><code class="docutils literal notranslate"><span class="pre">segment</span> <span class="pre">coordinates</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span> <span class="pre">&lt;resid&gt;</span></code></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="system-building-functions">
<h2>System building functions<a class="headerlink" href="#system-building-functions" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Task</th>
<th class="head">TCL command</th>
<th class="head">Python class equivalent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Guess coordinates of atoms that aren’t explicitly set</td>
<td><code class="docutils literal notranslate"><span class="pre">guesscoord</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.guess_coords()</span></code> <code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.guess_coords()</span></code></td>
</tr>
<tr class="row-odd"><td>Set coordinates of a given atom</td>
<td><code class="docutils literal notranslate"><span class="pre">coord</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span> <span class="pre">&lt;resid&gt;</span> <span class="pre">&lt;atomname&gt;</span> <span class="pre">{x</span> <span class="pre">y</span> <span class="pre">z}</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.set_coord(segid,</span> <span class="pre">resid,</span> <span class="pre">atomname,</span> <span class="pre">position)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.set_coord" title="psfgen.PsfGen.set_coord"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.set_coord()</span></code></a></td>
</tr>
<tr class="row-even"><td>Delete all atoms in a segment</td>
<td><code class="docutils literal notranslate"><span class="pre">delatom</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Delete all atoms in a residue</td>
<td><code class="docutils literal notranslate"><span class="pre">delatom</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span> <span class="pre">&lt;resid&gt;</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Delete a single atom</td>
<td><code class="docutils literal notranslate"><span class="pre">delatom</span> <span class="pre">&lt;segment</span> <span class="pre">ID&gt;</span> <span class="pre">&lt;resid&gt;</span> <span class="pre">&lt;atom</span> <span class="pre">name&gt;</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Create multiple images of a set of atoms for locally enhanced sampling</td>
<td><code class="docutils literal notranslate"><span class="pre">multiply</span> <span class="pre">&lt;factor&gt;</span> <span class="pre">&lt;segid[:resid[:atomname]]&gt;</span> <span class="pre">...</span></code></td>
<td>Not implemented</td>
</tr>
<tr class="row-even"><td>Remove insertion codes and modify resids minimially for uniqueness</td>
<td><code class="docutils literal notranslate"><span class="pre">regenerate</span> <span class="pre">resids</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.regenerate_resids()</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.regenerate_resids" title="psfgen.PsfGen.regenerate_resids"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.regenerate_resids()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Remove angles and regenerate them, after patching</td>
<td><code class="docutils literal notranslate"><span class="pre">regenerate</span> <span class="pre">angles</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.regenerate_angles()</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.regenerate_angles" title="psfgen.PsfGen.regenerate_angles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.regenerate_angles()</span></code></a></td>
</tr>
<tr class="row-even"><td>Remove dihedrals and regenerate them, after patching.</td>
<td><code class="docutils literal notranslate"><span class="pre">regenerate</span> <span class="pre">dihedrals</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.regenerate_dihedrals()</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.regenerate_dihedrals" title="psfgen.PsfGen.regenerate_dihedrals"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.regenerate_dihedrals()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Apply a patch to one or more residues, as determined by the patch</td>
<td><code class="docutils literal notranslate"><span class="pre">patch</span> <span class="pre">&lt;patchname&gt;</span> <span class="pre">&lt;segid:resid&gt;</span> <span class="pre">[...]</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.patch(patch_name,</span> <span class="pre">targets)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.patch" title="psfgen.PsfGen.patch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.patch()</span></code></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="adding-a-new-segment">
<h2>Adding a new segment<a class="headerlink" href="#adding-a-new-segment" title="Permalink to this headline">¶</a></h2>
<p>All of the following TCL code to create a new segment is equivalent to the
following Python code:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span>segment &lt;segment ID&gt; {                    # Create a new segment with given ID
    first &lt;patchname&gt;                     # Set patch applied to first residue
    last  &lt;patchname&gt;                     # Set patch applied to last residue
    pdb &lt;pdbfilename&gt;                     # Extract sequence info from given PDB file
    auto [angles|dihedrals|none]          # Automatically generate these

    residue &lt;resid&gt; &lt;resname&gt; [&lt;chain&gt;]   # Add a residue to the end of segment
    mutate &lt;resid&gt; &lt;resname&gt;              # Mutate a residue in current segment to a new one
}
</pre></div>
</div>
<p>All of this block is equivalent to the <a class="reference internal" href="api.html#psfgen.PsfGen.add_segment" title="psfgen.PsfGen.add_segment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.add_segment()</span></code></a>
function call in Python, with the <cite>segid</cite> argument being mandatory, and all
others optional:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gen</span><span class="o">.</span><span class="n">add_segment</span><span class="p">(</span><span class="n">segid</span><span class="o">=&lt;</span><span class="n">segment</span> <span class="n">ID</span><span class="o">&gt;</span><span class="p">,</span>
                <span class="n">first</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">last</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">pdbfile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">auto</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">residue</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">mutate</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="i-o-functions">
<h2>I/O functions<a class="headerlink" href="#i-o-functions" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Task</th>
<th class="head">TCL command</th>
<th class="head">Python class equivalent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Write out structure to a PSF file</td>
<td><code class="docutils literal notranslate"><span class="pre">writepsf</span> <span class="pre">[charmm]</span> <span class="pre">[x-plor]</span> <span class="pre">[cmap|nocmap]</span> <span class="pre">&lt;filename&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.write_psf(filename,</span> <span class="pre">type)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.write_psf" title="psfgen.PsfGen.write_psf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.write_psf()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Write out structure to a PDB file</td>
<td><code class="docutils literal notranslate"><span class="pre">writepdb</span> <span class="pre">&lt;filename&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.write_pdb(filename)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.write_pdb" title="psfgen.PsfGen.write_pdb"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.write_pdb()</span></code></a></td>
</tr>
<tr class="row-even"><td>Write out a NAMD binary input file</td>
<td><code class="docutils literal notranslate"><span class="pre">writenamdbin</span> <span class="pre">&lt;filename&gt;</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Read in a PSF file and add it to the current structure. Optionally
read coordinates from a pdb file or a namdbin file.</td>
<td><code class="docutils literal notranslate"><span class="pre">readpsf</span> <span class="pre">&lt;filename&gt;</span> <span class="pre">[pdb]</span> <span class="pre">&lt;pdbfilename&gt;</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Read coordinates in from a PDB file, matching segment, residue, and atom
names</td>
<td><code class="docutils literal notranslate"><span class="pre">coordpdb</span> <span class="pre">&lt;filename&gt;</span> <span class="pre">[segid]</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen.read_coords(filename,</span> <span class="pre">segid)</span></code> <a class="reference internal" href="api.html#psfgen.PsfGen.read_coords" title="psfgen.PsfGen.read_coords"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psfgen.PsfGen.read_coords()</span></code></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="context-functions">
<h2>Context functions<a class="headerlink" href="#context-functions" title="Permalink to this headline">¶</a></h2>
<p>The TCL version of psfgen has the concept of a “psf context”, that is, a given
molecule or system that is being built. You can use the TCL methods in the
table below to generate new contexts or switch between them to build multiple
molecules at once.</p>
<p>However since Python is object oriented, all you need to do to have multiple
systems in memory is create multiple PsfGen objects. Each one is self-contained.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Task</th>
<th class="head">TCL command</th>
<th class="head">Python class equivalent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Create a new context, with its own structure, topology definitions,
and aliases, and set it to active</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">new</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen</span> <span class="pre">=</span> <span class="pre">new</span> <span class="pre">PsfGen()</span></code></td>
</tr>
<tr class="row-odd"><td>Create a new context, but do not switch to it.</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">create</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">gen</span> <span class="pre">=</span> <span class="pre">new</span> <span class="pre">PsfGen()</span></code></td>
</tr>
<tr class="row-even"><td>Delete a psfcontext</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">delete</span> <span class="pre">&lt;context&gt;</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">gen</span></code></td>
</tr>
<tr class="row-odd"><td>Switch to a diferent psfcontext</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">&lt;id&gt;</span></code></td>
<td>Use multiple PsfGen objects</td>
</tr>
<tr class="row-even"><td>Make context case sensitive (by default it is not)</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">mixedcase</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Make context case insensitive (default setting)</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">allcaps</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Clear the structure, topology definitions, and aliases</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">reset</span></code></td>
<td>Delete and make a new PsfGen object</td>
</tr>
<tr class="row-odd"><td>Evaluate commands in a given context, returning to the current one when
done</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">eval</span> <span class="pre">&lt;context&gt;</span> <span class="pre">{</span> <span class="pre">&lt;commands&gt;</span> <span class="pre">}</span></code></td>
<td>Use multiple PsfGen objects</td>
</tr>
<tr class="row-even"><td>Get total number of contexts created and destroyed so far</td>
<td><code class="docutils literal notranslate"><span class="pre">psfcontext</span> <span class="pre">stats</span></code></td>
<td>Use multiple PsfGen objects</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="psfgen - python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Robin Betz.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.0a1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>